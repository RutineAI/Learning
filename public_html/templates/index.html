<script>
    document.getElementById("task-form").addEventListener("submit", async (e) => {
        e.preventDefault();
        const description = document.getElementById("description").value;
        const bikeDetails = document.getElementById("bike-details").value;
        const cost = document.getElementById("cost").value;

        const response = await fetch("/tasks", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ description, bike_details: bikeDetails, cost }),
        });

        const data = await response.json();
        console.log(data);

        // Display confirmation message
        const confirmationMessage = document.getElementById("confirmation-message");
        confirmationMessage.textContent = `Task created with ID: ${data.task}`;
        setTimeout(() => {
            confirmationMessage.textContent = "";
        }, 3000);

        // Clear input fields
        document.getElementById("description").value = "";
        document.getElementById("bike-details").value = "";
        document.getElementById("cost").value = "";

        // Fetch updated tasks
        fetchTasks();
    });

    async function fetchTasks() {
        const response = await fetch("/tasks");
        const tasks = await response.json();
        const taskList = document.getElementById("task-list");
        taskList.innerHTML = ""; // Clear existing task list
        tasks.forEach(task => {
            const li = document.createElement("li");
            li.textContent = `Task: ${task.description}, Bike Details: ${task.bike_details}, Cost: ${task.cost}`;
            taskList.appendChild(li);
        });
    }

    fetchTasks();
</script>
